<div data-ng-controller="secCtrl"></div>

<article class="modulo anchura_full">
	<header>
		<h3 class="tabs_involved">Nuevo Presupuesto {{prep.anua}}</h3>
	</header>

	<div class="contenedor_tabla">
		<table class="listado"> 
			<thead> 
				<tr>  
					<th style="width: 20%;">Categoria</th>
					<th style="width: 20%;">Concepto</th>
					<th style="width: 12%;">Periodicidad</th> 
					<th style="width: 12%;">Inicio</th>
					<th style="width: 12%;">Fin</th>
					<th style="width:  8%;">Importe</th> 
					<th style="width:  8%;">Total</th>  
					<th style="width:  8%;">Acciones</th>
				</tr> 
			</thead> 
			<tbody > 
				<tr data-ng-repeat="prep in prepList">   
					<td>{{cateMap[prep.cate].desc}}</td>
					<td class="left">{{cateMap[prep.cate].concMap[prep.conc].desc}}</td>
					<td class="left">{{parPeriMap[prep.peri].desc}}</td>
					<td class="left">{{parMesMap[prep.mini > 9 || prep.mini == 0 ? "" + prep.mini: "0" + prep.mini].desc}}</td>
					<td class="left">{{parMesMap[prep.mfin > 9 || prep.mfin == 0 ? "" + prep.mfin: "0" + prep.mfin].desc}}</td>
					<td class="right">{{prep.impo | number:2}} &euro;</td> 
					<td class="right">{{prep.tota | number:2}} &euro;</td> 
					<td class="center"><a href="" data-ng-click="editPrep(prep.iden, prep.cate, prep.conc, prep.peri, prep.mini, prep.mfin, prep.impo);"><input type="image" src="images/icn_editar.png" title="Editar"></a><a href="" data-ng-click="borrPrep(prep.iden)"><input type="image" src="images/icn_delete.png" title="Borrar"></a></td>
				</tr>
				<tr>
					<td><select style="width:92%;" data-ng-model="prep.cate" data-ng-options="cate.iden as cate.desc for cate in cateList" data-ng-change="cateChange();"></select></td>
					<td><select style="width:92%;" data-ng-model="prep.conc" data-ng-options="conc.iden as conc.desc for conc in concList"></select></td>
					<td><select data-ng-model="prep.peri" data-ng-options="parm.clav as parm.desc for parm in parPeriList"></select></td>
					<td><select data-ng-model="prep.mini" data-ng-options="parm.clav as parm.desc for parm in parMesList"></select></td>
					<td><select data-ng-model="prep.mfin" data-ng-options="parm.clav as parm.desc for parm in parMesList"></select></td>
					<td><input type="text" data-ng-model="prep.impo"/></td>
					<td></td>
					<td><a href="" data-ng-click="savePrep();"><input type="image" src="images/icn_aceptar.png" title="Aceptar"></a></td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<th>Total</th>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td class="right">{{prepList | sumByKey:'tota' | number:2}} &euro;</td>
				</tr>
			</tfoot> 
		</table>
	</div>
</article>

<article class="modulo anchura_full">
	<header>
		<h3 class="tabs_involved">Resumen {{prep.anua - 1}} <a href="" data-ng-click="copy()" data-ng-show="prepList.length == 0">Copiar</a></h3>
	</header>
	
	<table class="listado"> 
			<thead> 
				<tr>  
					<th style="width: 20%;">Categoria</th>
					<th style="width: 20%;">Concepto</th>
					<th style="width: 12%;">Periodicidad</th> 
					<th style="width: 12%;">Inicio</th>
					<th style="width: 12%;">Fin</th>
					<th style="width:  8%;">Importe</th> 
					<th style="width:  8%;">Total</th>  
					<th style="width:  8%;"></th>
				</tr> 
			</thead> 
			<tbody > 
				<tr data-ng-repeat="prepAnte in prepAnteList">   
					<td>{{cateMap[prepAnte.cate].desc}}</td>
					<td class="left">{{cateMap[prepAnte.cate].concMap[prepAnte.conc].desc}}</td>
					<td class="left">{{parPeriMap[prepAnte.peri].desc}}</td>
					<td class="left">{{parMesMap[prepAnte.mini > 9 || prepAnte.mini == 0 ? "" + prepAnte.mini: "0" + prepAnte.mini].desc}}</td>
					<td class="left">{{parMesMap[prepAnte.mfin > 9 || prepAnte.mfin == 0 ? "" + prepAnte.mfin: "0" + prepAnte.mfin].desc}}</td>
					<td class="right">{{prepAnte.impo | number:2}} &euro;</td> 
					<td class="right">{{prepAnte.tota | number:2}} &euro;</td> 
					<td class="center"></td>
				</tr>
			</tbody> 
	</table>
</article>